Ideas for increasing speed:
Hash table
Top down dynamic programming